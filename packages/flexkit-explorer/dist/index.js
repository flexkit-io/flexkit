'use strict';

var lucideReact = require('lucide-react');
var react = require('react');
var toolkit = require('@graphiql/toolkit');
var studio = require('@flexkit/studio');
var react$1 = require('@graphiql/react');
var jsxRuntime = require('react/jsx-runtime');
require('@graphiql/react/dist/style.css');

var Qe=Object.defineProperty;var R=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var oe=(t,l,a)=>l in t?Qe(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,se=(t,l)=>{for(var a in l||(l={}))le.call(l,a)&&oe(t,a,l[a]);if(R)for(var a of R(l))re.call(l,a)&&oe(t,a,l[a]);return t};var ne=(t,l)=>{var a={};for(var r in t)le.call(t,r)&&l.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&R)for(var r of R(t))l.indexOf(r)<0&&re.call(t,r)&&(a[r]=t[r]);return a};var de=(t,l,a)=>new Promise((r,f)=>{var u=h=>{try{c(a.next(h));}catch(p){f(p);}},s=h=>{try{c(a.throw(h));}catch(p){f(p);}},c=h=>h.done?r(h.value):Promise.resolve(h.value).then(u,s);c((a=a.apply(t,l)).next());});function N(U){var v=U,{dangerouslyAssumeSchemaIsValid:t,confirmCloseTab:l,defaultQuery:a,defaultTabs:r,externalFragments:f,fetcher:u,getDefaultFieldNames:s,headers:c,inputValueDeprecation:h,introspectionQueryName:p,maxHistoryLength:b,onEditOperationName:A,onSchemaChange:I,onTabChange:O,onTogglePluginVisibility:S,operationName:g,plugins:J,query:d,response:y,schema:z,schemaDescription:L,shouldPersistHeaders:T,storage:P,validationRules:x,variables:G,visiblePlugin:D,defaultHeaders:F}=v,H=ne(v,["dangerouslyAssumeSchemaIsValid","confirmCloseTab","defaultQuery","defaultTabs","externalFragments","fetcher","getDefaultFieldNames","headers","inputValueDeprecation","introspectionQueryName","maxHistoryLength","onEditOperationName","onSchemaChange","onTabChange","onTogglePluginVisibility","operationName","plugins","query","response","schema","schemaDescription","shouldPersistHeaders","storage","validationRules","variables","visiblePlugin","defaultHeaders"]);var M;if(typeof u!="function")throw new TypeError("The `GraphiQL` component requires a `fetcher` function to be passed as prop.");return jsxRuntime.jsx(react$1.GraphiQLProvider,{getDefaultFieldNames:s,dangerouslyAssumeSchemaIsValid:t,defaultQuery:a,defaultHeaders:F,defaultTabs:r,externalFragments:f,fetcher:u,headers:c,inputValueDeprecation:h,introspectionQueryName:p,maxHistoryLength:b,onEditOperationName:A,onSchemaChange:I,onTabChange:O,onTogglePluginVisibility:S,plugins:J,visiblePlugin:D,operationName:g,query:d,response:y,schema:z,schemaDescription:L,shouldPersistHeaders:T,storage:P,validationRules:x,variables:G,children:jsxRuntime.jsx(Tt,se({confirmCloseTab:l,showPersistHeadersSettings:T!==!1,disableTabs:(M=H.disableTabs)!=null?M:!1,forcedTheme:H.forcedTheme},H))})}N.Toolbar=pe;N.Footer=be;var yt=["light","dark","system"],w="graphiql-session-tab-";function Tt(t){var Z,ee,te,ae;let l=(Z=t.isHeadersEditorEnabled)!=null?Z:!0,a=react$1.useEditorContext({nonNull:!0}),r=react$1.useExecutionContext({nonNull:!0});react$1.useSchemaContext({nonNull:!0});let u=react$1.useStorageContext(),s=react$1.usePluginContext(),[c,h]=react.useState(!1),p=react.useRef(null),b=react.useMemo(()=>t.forcedTheme&&yt.includes(t.forcedTheme)?t.forcedTheme:void 0,[t.forcedTheme]),A=react$1.useCopyQuery({onCopyQuery:t.onCopyQuery}),I=react$1.useMergeQuery(),O=react$1.usePrettifyEditors(),{theme:S,setTheme:g}=react$1.useTheme(t.defaultTheme);react.useEffect(()=>{b==="system"?g(null):(b==="light"||b==="dark")&&g(b);},[b,g]),react.useEffect(()=>{s==null||s.setVisiblePlugin(s.plugins[0]);},[s]);react$1.useDragResize({direction:"horizontal",storageKey:"editorFlex"});let d=react$1.useDragResize({defaultSizeRelation:3,direction:"vertical",initiallyHidden:(()=>{if(!(t.defaultEditorToolsVisibility==="variables"||t.defaultEditorToolsVisibility==="headers"))return typeof t.defaultEditorToolsVisibility=="boolean"?t.defaultEditorToolsVisibility?void 0:"second":a.initialVariables||a.initialHeaders?void 0:"second"})(),sizeThresholdSecond:60,storageKey:"secondaryEditorFlex"}),[y,z]=react.useState(()=>t.defaultEditorToolsVisibility==="variables"||t.defaultEditorToolsVisibility==="headers"?t.defaultEditorToolsVisibility:!a.initialVariables&&a.initialHeaders&&l?"headers":"variables"),[L,T]=react.useState(null),[P,x]=react.useState(null),G=react.Children.toArray(t.children),D=(ae=G.find(i=>fe(i,N.Toolbar)))!=null?ae:jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx(react$1.ToolbarButton,{onClick:O,label:"Prettify query (Shift-Ctrl-P)",children:jsxRuntime.jsx(react$1.PrettifyIcon,{className:"fk-w-8 fk-h-8 fk-block","aria-hidden":"true"})}),jsxRuntime.jsx(react$1.ToolbarButton,{onClick:I,label:"Merge fragments into query (Shift-Ctrl-M)",children:jsxRuntime.jsx(react$1.MergeIcon,{className:"graphiql-toolbar-icon","aria-hidden":"true"})}),jsxRuntime.jsx(react$1.ToolbarButton,{onClick:A,label:"Copy query (Shift-Ctrl-C)",children:jsxRuntime.jsx(react$1.CopyIcon,{className:"graphiql-toolbar-icon","aria-hidden":"true"})}),(ee=t.toolbar)==null?void 0:ee.additionalContent,((te=t.toolbar)==null?void 0:te.additionalComponent)&&jsxRuntime.jsx(t.toolbar.additionalComponent,{})]}),F=G.find(i=>fe(i,N.Footer)),H=react.useCallback(()=>{try{u==null||u.clear(),x("success");}catch(i){x("error");}},[u]),U=react.useCallback(i=>{a.setShouldPersistHeaders(i.currentTarget.dataset.value==="true");},[a]),v=react.useCallback(i=>{let n=i.currentTarget.dataset.theme;g(n||null);},[g]),M=()=>{a.addTab();},Te=i=>{a.moveTab(i);};react.useCallback(i=>{T(i.currentTarget.dataset.value);},[]);let ve=react.useCallback(i=>{var ie;let n=s,k=Number(i.currentTarget.dataset.index);if(!n)return;let Q=(ie=n.plugins.find((qt,He)=>k===He))!=null?ie:null;if(Q===n.visiblePlugin){n.setVisiblePlugin(null);return}n.setVisiblePlugin(Q);},[s]),Y=react.useCallback(i=>{d.hiddenElement==="second"&&d.setHiddenElement(null),z(i.currentTarget.dataset.name);},[d]),ke=react.useCallback(()=>{d.setHiddenElement(d.hiddenElement==="second"?null:"second");},[d]),Ee=react.useCallback(i=>{i||T(null);},[]),Ce=react.useCallback(i=>{i||(T(null),x(null));},[]),Ne=jsxRuntime.jsx(react$1.Tooltip,{label:"Add tab",children:jsxRuntime.jsx(react$1.UnStyledButton,{type:"button",className:"graphiql-tab-add",onClick:M,"aria-label":"Add tab",children:jsxRuntime.jsx(react$1.PlusIcon,{"aria-hidden":"true"})})}),Se=t.className?` ${t.className}`:"",$=t.confirmCloseTab,Pe=react.useCallback(i=>de(this,null,function*(){let n=i.currentTarget.previousSibling,k=Number(n.id.replace(w,""));(!$||(yield $(k)))&&(a.activeTabIndex===k&&r.stop(),a.closeTab(k));}),[$,a,r]),xe=react.useCallback(i=>{let n=Number(i.currentTarget.id.replace(w,""));r.stop(),a.changeTab(n);},[a,r]);return jsxRuntime.jsx(react$1.Tooltip.Provider,{children:jsxRuntime.jsxs("div",{className:`graphiql-container${Se}`,children:[jsxRuntime.jsxs(studio.ResizablePanelGroup,{autoSaveId:"explorer",direction:"horizontal",className:"fk-h-full fk-max-h-full",children:[jsxRuntime.jsx(studio.ResizablePanel,{collapsible:!0,collapsedSize:3,minSize:10,onCollapse:()=>{h(!0);},onExpand:()=>{h(!1);},ref:p,children:jsxRuntime.jsx("div",{className:"fk-flex fk-w-full fk-h-full fk-pb-6",children:jsxRuntime.jsxs(studio.Tabs,{className:"fk-w-full",defaultValue:s==null?void 0:s.plugins[0].title,children:[jsxRuntime.jsxs("div",{className:`fk-flex fk-items-center fk-py-1 ${c?"":"fk-px-4"}`,children:[jsxRuntime.jsx(studio.TabsList,{className:c?"fk-hidden":"",children:s==null?void 0:s.plugins.map((i,n)=>{let Q=`${i===s.visiblePlugin?"Hide":"Show"} ${i.title}`;return jsxRuntime.jsx(studio.TabsTrigger,{"aria-label":Q,className:"fk-text-muted-foreground","data-index":n,onClick:ve,value:i.title,children:jsxRuntime.jsx(i.icon,{"aria-hidden":"true"})},i.title)})}),jsxRuntime.jsxs(studio.Tooltip,{children:[jsxRuntime.jsx(studio.TooltipTrigger,{asChild:!0,children:jsxRuntime.jsx(studio.Button,{className:c?"fk-ml-1.5":"fk-ml-auto",onClick:()=>{let i=p.current;c?i==null||i.expand():i==null||i.collapse();},size:"icon",variant:"ghost",children:c?jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx(lucideReact.ChevronsRight,{className:"fk-w-4 fk-h-4"}),jsxRuntime.jsx("span",{className:"fk-sr-only",children:"Expand"})]}):jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx(lucideReact.ChevronsLeft,{className:"fk-w-4 fk-h-4"}),jsxRuntime.jsx("span",{className:"fk-sr-only",children:"Collapse"})]})})}),jsxRuntime.jsx(studio.TooltipContent,{children:c?"Expand":"Collapse"})]})]}),c?null:jsxRuntime.jsx(studio.Separator,{}),s==null?void 0:s.plugins.map(i=>jsxRuntime.jsx(studio.TabsContent,{className:`fk-flex fk-w-full fk-max-h-full fk-mt-0 ${c?"fk-hidden":""}`,value:i.title,children:jsxRuntime.jsxs(studio.ScrollArea,{className:"fk-flex fk-w-full fk-max-h-full fk-overflow-auto fk-px-6 fk-pt-3 fk-pb-6 fk-mb-3",children:[jsxRuntime.jsx(i.content,{}),jsxRuntime.jsx(studio.ScrollBar,{orientation:"horizontal"})]})},i.title))]})})}),jsxRuntime.jsx(studio.ResizableHandle,{className:"hover:fk-bg-blue-500 fk-transition-colors",withHandle:!0}),jsxRuntime.jsx(studio.ResizablePanel,{className:"fk-bg-muted",defaultSize:48,children:jsxRuntime.jsxs("div",{className:"fk-flex fk-flex-col fk-h-full",children:[jsxRuntime.jsx("div",{className:"fk-flex fk-items-center fk-py-1 fk-px-4 fk-bg-background",children:!t.disableTabs&&jsxRuntime.jsx(react$1.Tabs,{"aria-label":"Select active operation",className:"!fk-p-1 fk-bg-muted fk-rounded-md",onReorder:Te,values:a.tabs,children:a.tabs.length>0&&jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[a.tabs.map((i,n)=>jsxRuntime.jsxs(react$1.Tab,{className:"fk-bg-background",isActive:n===a.activeTabIndex,value:i,children:[jsxRuntime.jsx(react$1.Tab.Button,{"aria-controls":"graphiql-session",id:`${w}${n.toString()}`,onClick:xe,children:i.title}),jsxRuntime.jsx(react$1.Tab.Close,{onClick:Pe})]},i.id)),Ne]})})}),jsxRuntime.jsx("div",{role:"tabpanel",id:"graphiql-session",className:"graphiql-session","aria-labelledby":`${w}${a.activeTabIndex}`,children:jsxRuntime.jsxs("div",{className:`graphiql-editors${a.tabs.length===1?" full-height":""}`,children:[jsxRuntime.jsx("div",{ref:d.firstRef,children:jsxRuntime.jsxs("section",{className:"graphiql-query-editor","aria-label":"Query Editor",children:[jsxRuntime.jsx(react$1.QueryEditor,{editorTheme:t.editorTheme,keyMap:t.keyMap,onCopyQuery:t.onCopyQuery,onEdit:t.onEditQuery,readOnly:t.readOnly}),jsxRuntime.jsxs("div",{className:"graphiql-toolbar",role:"toolbar","aria-label":"Editor Commands",children:[jsxRuntime.jsx(react$1.ExecuteButton,{}),D]})]})}),jsxRuntime.jsx("div",{ref:d.dragBarRef,children:jsxRuntime.jsxs("div",{className:"graphiql-editor-tools",children:[jsxRuntime.jsx(react$1.UnStyledButton,{type:"button",className:y==="variables"&&d.hiddenElement!=="second"?"active":"",onClick:Y,"data-name":"variables",children:"Variables"}),l&&jsxRuntime.jsx(react$1.UnStyledButton,{type:"button",className:y==="headers"&&d.hiddenElement!=="second"?"active":"",onClick:Y,"data-name":"headers",children:"Headers"}),jsxRuntime.jsx(react$1.Tooltip,{label:d.hiddenElement==="second"?"Show editor tools":"Hide editor tools",children:jsxRuntime.jsx(react$1.UnStyledButton,{type:"button",onClick:ke,"aria-label":d.hiddenElement==="second"?"Show editor tools":"Hide editor tools",className:"graphiql-toggle-editor-tools",children:d.hiddenElement==="second"?jsxRuntime.jsx(react$1.ChevronUpIcon,{className:"graphiql-chevron-icon","aria-hidden":"true"}):jsxRuntime.jsx(react$1.ChevronDownIcon,{className:"graphiql-chevron-icon","aria-hidden":"true"})})})]})}),jsxRuntime.jsxs("section",{className:"graphiql-editor-tool","aria-label":y==="variables"?"Variables":"Headers",children:[jsxRuntime.jsx(react$1.VariableEditor,{editorTheme:t.editorTheme,isHidden:y!=="variables",keyMap:t.keyMap,onEdit:t.onEditVariables,readOnly:t.readOnly}),l&&jsxRuntime.jsx(react$1.HeaderEditor,{editorTheme:t.editorTheme,isHidden:y!=="headers",keyMap:t.keyMap,onEdit:t.onEditHeaders,readOnly:t.readOnly})]})]})})]})}),jsxRuntime.jsx(studio.ResizableHandle,{className:"hover:fk-bg-blue-500 fk-transition-colors",withHandle:!0}),jsxRuntime.jsx(studio.ResizablePanel,{className:"fk-p-3 fk-relative fk-z-50",defaultSize:30,children:jsxRuntime.jsxs("div",{className:"graphiql-response fk-h-full",children:[r.isFetching?jsxRuntime.jsx(react$1.Spinner,{}):null,jsxRuntime.jsx(react$1.ResponseEditor,{editorTheme:t.editorTheme,responseTooltip:t.responseTooltip,keyMap:t.keyMap}),F]})})]}),jsxRuntime.jsxs(react$1.Dialog,{open:L==="short-keys",onOpenChange:Ee,children:[jsxRuntime.jsxs("div",{className:"graphiql-dialog-header",children:[jsxRuntime.jsx(react$1.Dialog.Title,{className:"graphiql-dialog-title",children:"Short Keys"}),jsxRuntime.jsx(react$1.Dialog.Close,{})]}),jsxRuntime.jsx("div",{className:"graphiql-dialog-section",children:jsxRuntime.jsx(kt,{keyMap:t.keyMap||"sublime"})})]}),jsxRuntime.jsxs(react$1.Dialog,{open:L==="settings",onOpenChange:Ce,children:[jsxRuntime.jsxs("div",{className:"graphiql-dialog-header",children:[jsxRuntime.jsx(react$1.Dialog.Title,{className:"graphiql-dialog-title",children:"Settings"}),jsxRuntime.jsx(react$1.Dialog.Close,{})]}),t.showPersistHeadersSettings?jsxRuntime.jsxs("div",{className:"graphiql-dialog-section",children:[jsxRuntime.jsxs("div",{children:[jsxRuntime.jsx("div",{className:"graphiql-dialog-section-title",children:"Persist headers"}),jsxRuntime.jsxs("div",{className:"graphiql-dialog-section-caption",children:["Save headers upon reloading."," ",jsxRuntime.jsx("span",{className:"graphiql-warning-text",children:"Only enable if you trust this device."})]})]}),jsxRuntime.jsxs(react$1.ButtonGroup,{children:[jsxRuntime.jsx(react$1.Button,{type:"button",id:"enable-persist-headers",className:a.shouldPersistHeaders?"active":"","data-value":"true",onClick:U,children:"On"}),jsxRuntime.jsx(react$1.Button,{type:"button",id:"disable-persist-headers",className:a.shouldPersistHeaders?"":"active",onClick:U,children:"Off"})]})]}):null,!b&&jsxRuntime.jsxs("div",{className:"graphiql-dialog-section",children:[jsxRuntime.jsxs("div",{children:[jsxRuntime.jsx("div",{className:"graphiql-dialog-section-title",children:"Theme"}),jsxRuntime.jsx("div",{className:"graphiql-dialog-section-caption",children:"Adjust how the interface appears."})]}),jsxRuntime.jsxs(react$1.ButtonGroup,{children:[jsxRuntime.jsx(react$1.Button,{type:"button",className:S===null?"active":"",onClick:v,children:"System"}),jsxRuntime.jsx(react$1.Button,{type:"button",className:S==="light"?"active":"","data-theme":"light",onClick:v,children:"Light"}),jsxRuntime.jsx(react$1.Button,{type:"button",className:S==="dark"?"active":"","data-theme":"dark",onClick:v,children:"Dark"})]})]}),u?jsxRuntime.jsxs("div",{className:"graphiql-dialog-section",children:[jsxRuntime.jsxs("div",{children:[jsxRuntime.jsx("div",{className:"graphiql-dialog-section-title",children:"Clear storage"}),jsxRuntime.jsx("div",{className:"graphiql-dialog-section-caption",children:"Remove all locally stored data and start fresh."})]}),jsxRuntime.jsx(react$1.Button,{type:"button",state:P||void 0,disabled:P==="success",onClick:H,children:{success:"Cleared data",error:"Failed"}[P]||"Clear data"})]}):null]})]})})}var X=react$1.isMacOs?"\u2318":"Ctrl",vt=Object.entries({"Search in editor":[X,"F"],"Search in documentation":[X,"K"],"Execute query":[X,"Enter"],"Prettify editors":["Ctrl","Shift","P"],"Merge fragments definitions into operation definition":["Ctrl","Shift","M"],"Copy query":["Ctrl","Shift","C"],"Re-fetch schema using introspection":["Ctrl","Shift","R"]});function kt({keyMap:t}){return jsxRuntime.jsxs("div",{children:[jsxRuntime.jsxs("table",{className:"graphiql-table",children:[jsxRuntime.jsx("thead",{children:jsxRuntime.jsxs("tr",{children:[jsxRuntime.jsx("th",{children:"Short Key"}),jsxRuntime.jsx("th",{children:"Function"})]})}),jsxRuntime.jsx("tbody",{children:vt.map(([l,a])=>jsxRuntime.jsxs("tr",{children:[jsxRuntime.jsx("td",{children:a.map((r,f,u)=>jsxRuntime.jsxs(react.Fragment,{children:[jsxRuntime.jsx("code",{className:"graphiql-key",children:r}),f!==u.length-1&&" + "]},r))}),jsxRuntime.jsx("td",{children:l})]},l))})]}),jsxRuntime.jsxs("p",{children:["The editors use"," ",jsxRuntime.jsx("a",{href:"https://codemirror.net/5/doc/manual.html#keymaps",target:"_blank",rel:"noopener noreferrer",children:"CodeMirror Key Maps"})," ","that add more short keys. This instance of Graph",jsxRuntime.jsx("em",{children:"i"}),"QL uses ",jsxRuntime.jsx("code",{children:t}),"."]})]})}function pe(t){return jsxRuntime.jsx(jsxRuntime.Fragment,{children:t.children})}pe.displayName="GraphiQLToolbar";function be(t){return jsxRuntime.jsx("div",{className:"graphiql-footer",children:t.children})}be.displayName="GraphiQLFooter";function fe(t,l){var a;return (a=t==null?void 0:t.type)!=null&&a.displayName&&t.type.displayName===l.displayName?!0:t.type===l}function ge(){let{currentProjectId:t}=studio.useConfig(),l=`https://${t}.api.flexkit.io/graphql`,a=react.useMemo(()=>toolkit.createGraphiQLFetcher({url:l}),[l]);return jsxRuntime.jsx(N,{fetcher:a})}function Jt(){return {name:"flexkit.explorer",contributes:{apps:[{name:"explorer",icon:jsxRuntime.jsx(lucideReact.SquarePlay,{strokeWidth:1.5}),title:"Explorer",component:jsxRuntime.jsx(ge,{}),routes:[]}]}}}

exports.Explorer = Jt;
